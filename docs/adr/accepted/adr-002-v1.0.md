# ADR-002: Project Skills as Platform Engineering

**Status:** Accepted
**Date:** 2025-12-21
**Context:** As we scale the `@lifesciences-research` project, ensuring consistent implementation of architectural patterns (e.g., FastMCP scaffolding, deployment safety) becomes critical. Relying on manual prompting or copy-pasting boilerplate leads to drift and "cognitive load" for developers. We need a mechanism to enforce disciplined engineering practices within the agentic workflow itself.

**Reference:** *Team Topologies* (Pais & Skelton) - "Platform Teams" reduce cognitive load by providing internal products that enable "Stream-aligned Teams" to deliver faster.

## 1. Context and Problem Statement

When using agentic coding tools like Claude Code, "success" depends heavily on the model's adherence to project-specific constraints. Without explicit guidance, the agent may invent novel (but non-standard) directory structures, skip safety checks during deployment, or use outdated dependency management tools.

We need a method to abstract these "Golden Paths" so that the agent acts as a disciplined engineer, effectively treating the IDE environment as a "Platform" that guides development.

## 2. Decision: Skills as "Platform-as-Product"

We will adopt **Project Skills** (stored in `.claude/skills/`) as the primary mechanism for distributing architectural standards and engineering capabilities to the team.

* **Project-Level Scope:** Skills will be committed to the git repository in `.claude/skills/`. This ensures that every team member (and their agent) automatically acquires the latest architectural capabilities upon `git pull`.


* 
**Model-Invoked Execution:** We rely on the agent's autonomous ability to invoke skills based on intent (e.g., "Scaffold a new API") rather than forcing users to memorize slash commands.


* **Progressive Disclosure:** We will strictly separate logic (`SKILL.md`) from boilerplate (`templates/`). The agent will read templates only when the skill is active, preserving context window space.



## 3. Implementation Standard: The Skill Structure

Every standardized engineering task must be encapsulated in a dedicated skill directory following this schema:

```text
.claude/skills/
└── {capability-name}/
    ├── SKILL.md            # The "Contract": Instructions & Triggers
    ├── templates/          # The "Assets": Boilerplate files
    └── scripts/            # The "Logic": Validation or execution scripts

```

### Pattern A: The Scaffolder (FastMCPv2)

To enforce the `ADR-001` architecture, we define a scaffolding skill.

* **Trigger:** "Create a new MCP server", "Scaffold API".
* **Mechanism:** The skill reads `templates/pyproject.toml` (configured for `uv` and `fastmcp`) and `templates/server.py` (with standard imports) and writes them to the target directory.
* **Constraint:** The skill instruction explicitly forbids creating "bare" Python scripts without the standard project structure.

### Pattern B: The Deployment Guardrail

To prevent unsafe deployments, we define a deployment skill using `allowed-tools`.

* **Trigger:** "Deploy to cloud", "Ship it".
* **Safety Mechanism:** The skill executes a pre-flight checklist (`ruff check`, `pytest`) *before* issuing the deployment command.
* **Tool Restriction:** The skill explicitly restricts write access during the deployment phase to prevent the agent from "fixing" code on the fly without review.

## 4. Consequences

**Positive:**

* **Reduced Cognitive Load:** Developers do not need to memorize CLI flags for scaffolding or deployment; the skill handles the implementation details.
* **Standardization:** Every new microservice created by the agent will have identical structure, dependencies, and configuration.
* 
**Onboarding:** New team members immediately access the team's "engineering wisdom" simply by cloning the repo.



**Negative:**

* **Maintenance Overhead:** The Platform Engineering team (or Lead Architect) must maintain the `templates/` to keep them up to date with library versions.
* **Prompt Tuning:** If the `description` in `SKILL.md` is too vague, the agent may fail to invoke the skill. We must treat skill descriptions as internal APIs that require testing.



## 5. Compliance

This decision aligns with the *Team Topologies* approach by treating the Claude Code environment as a "Thick Platform" that provides self-service capabilities to the stream-aligned developers.